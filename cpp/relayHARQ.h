/**
* Functions and classes used to formulate the Q3AP problem in relay-HARQ communication system.
*
*
*  \author      Wenhao Wu
*  \version     0.1
*  \date        2015-01-30
 */

#ifndef RELAYHARQ_H_
#define RELAYHARQ_H_

#include <armadillo>
#include <complex>
namespace relayHARQ {

/**
 * Different QAM constellations
 */
const std::vector<std::complex<double> > QAM4 {{-0.707106781186548, 0.707106781186548}, {-0.707106781186548, -0.707106781186548}, {0.707106781186548, 0.707106781186548}, {0.707106781186548, -0.707106781186548}};
const std::vector<std::complex<double> > QAM8 {{-1.22474487139159, 0.408248290463863}, {-1.22474487139159, -0.408248290463863}, {-0.408248290463863, 0.408248290463863}, {-0.408248290463863, -0.408248290463863}, {1.22474487139159, 0.408248290463863}, {1.22474487139159, -0.408248290463863}, {0.408248290463863, 0.408248290463863}, {0.408248290463863, -0.408248290463863}};
const std::vector<std::complex<double> > QAM16 {{-0.948683298050514, 0.948683298050514}, {-0.948683298050514, 0.316227766016838}, {-0.948683298050514, -0.948683298050514}, {-0.948683298050514, -0.316227766016838}, {-0.316227766016838, 0.948683298050514}, {-0.316227766016838, 0.316227766016838}, {-0.316227766016838, -0.948683298050514}, {-0.316227766016838, -0.316227766016838}, {0.948683298050514, 0.948683298050514}, {0.948683298050514, 0.316227766016838}, {0.948683298050514, -0.948683298050514}, {0.948683298050514, -0.316227766016838}, {0.316227766016838, 0.948683298050514}, {0.316227766016838, 0.316227766016838}, {0.316227766016838, -0.948683298050514}, {0.316227766016838, -0.316227766016838}};
const std::vector<std::complex<double> > QAM32 {{-0.670820393249937, 1.11803398874990}, {-0.223606797749979, 1.11803398874990}, {-0.670820393249937, -1.11803398874990}, {-0.223606797749979, -1.11803398874990}, {-1.11803398874990, 0.670820393249937}, {-1.11803398874990, 0.223606797749979}, {-1.11803398874990, -0.670820393249937}, {-1.11803398874990, -0.223606797749979}, {-0.223606797749979, 0.670820393249937}, {-0.223606797749979, 0.223606797749979}, {-0.223606797749979, -0.670820393249937}, {-0.223606797749979, -0.223606797749979}, {-0.670820393249937, 0.670820393249937}, {-0.670820393249937, 0.223606797749979}, {-0.670820393249937, -0.670820393249937}, {-0.670820393249937, -0.223606797749979}, {0.670820393249937, 1.11803398874990}, {0.223606797749979, 1.11803398874990}, {0.670820393249937, -1.11803398874990}, {0.223606797749979, -1.11803398874990}, {1.11803398874990, 0.670820393249937}, {1.11803398874990, 0.223606797749979}, {1.11803398874990, -0.670820393249937}, {1.11803398874990, -0.223606797749979}, {0.223606797749979, 0.670820393249937}, {0.223606797749979, 0.223606797749979}, {0.223606797749979, -0.670820393249937}, {0.223606797749979, -0.223606797749979}, {0.670820393249937, 0.670820393249937}, {0.670820393249937, 0.223606797749979}, {0.670820393249937, -0.670820393249937}, {0.670820393249937, -0.223606797749979}};

/**
 * Compute the pairwise error probability between 2 sets of symbols in the relay-HART model.
 */
double get_PEP_symbol(arma::cx_vec x, arma::cx_vec y, arma::vec mu_h, arma::cx_mat sigma2_h, arma::cx_mat sigma2_eps, arma::cx_mat sigma2_v, int N, double xi);

/**
 * Get the number of different bits between integers in [0, 2 ^ Nbps - 1]
 */
arma::umat get_n_diff_bits(int Nbps);

}
#endif
